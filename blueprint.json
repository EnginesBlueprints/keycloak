{
  "schema": {
    "type": "app_blueprint",
    "version": {
      "major": 0,
      "minor": 1
    },
    "origin": "Engines Developer Studio 0.2"
  },
  "metadata": {
    "blueprint": {
      "version": {
        "major": 0,
        "minor": 0,
        "level": "alpha",
        "patch": 0
      }
    },
    "timestamp": "2019-09-28T12:01:22+10:00"
  },
  "software": {
    "base": {
      "name": "keycloak",
      "framework": "openjdk8",
      "deployment_type": "web",
      "http_protocol": "https_only",
      "framework_port_override": 8080,
      "memory": {
        "required": 768,
        "recommended": 1024
      }
    },
    "scripts": {
      "start": {
        "language": "sh",
        "content": "#!/bin/sh\r\n\r\ncd /home/app/keycloak\r\nbin/standalone.sh  --server-config=standalone.xml\r\n\r\nsleep 3600"
      }
    },
    "installed_packages": [
      {
        "name": "keycloak-6.0.1.tar.gz",
        "download_type": "http(s)",
        "source_url": "https://downloads.jboss.org/keycloak/6.0.1/keycloak-6.0.1.tar.gz",
        "destination": "/home/app/keycloak",
        "extraction_command": "tar -xzpf ",
        "path_to_extracted": "keycloak-6.0.1"
      }
    ],
    "service_configurations": [
      {
        "publisher_namespace": "EnginesSystem",
        "type_path": "filesystem/local/filesystem",
        "variables": {
          "service_name": "data",
          "volume_src": "",
          "engine_path": "/home/app/keycloak/standalone/data",
          "permissions": "rw",
          "user": "_Engines_Builder(cont_user_id)",
          "group": "_Engines_Builder(data_gid)",
          "fw_user": "_Engines_Builder(cont_user_id)",
          "exclude_from_backup": "false"
        }
      },
      {
        "publisher_namespace": "EnginesSystem",
        "type_path": "filesystem/local/filesystem",
        "variables": {
          "service_name": "log",
          "volume_src": "",
          "engine_path": "",
          "permissions": "rw",
          "user": "_Engines_Builder(cont_user_id)",
          "group": "_Engines_Builder(data_gid)",
          "fw_user": "_Engines_Builder(cont_user_id)",
          "exclude_from_backup": "false"
        }
      }
    ],
    "template_files": [
      {
        "path": "/home/app/keycloak/standalone/configuration/standalone.xml",
        "content": "<?xml version='1.0' encoding='UTF-8'?>\r\n\r\n<server xmlns=\"urn:jboss:domain:10.0\">\r\n    <extensions>\r\n        <extension module=\"org.jboss.as.clustering.infinispan\"/>\r\n        <extension module=\"org.jboss.as.connector\"/>\r\n        <extension module=\"org.jboss.as.deployment-scanner\"/>\r\n        <extension module=\"org.jboss.as.ee\"/>\r\n        <extension module=\"org.jboss.as.ejb3\"/>\r\n        <extension module=\"org.jboss.as.jaxrs\"/>\r\n        <extension module=\"org.jboss.as.jmx\"/>\r\n        <extension module=\"org.jboss.as.jpa\"/>\r\n        <extension module=\"org.jboss.as.logging\"/>\r\n        <extension module=\"org.jboss.as.mail\"/>\r\n        <extension module=\"org.jboss.as.naming\"/>\r\n        <extension module=\"org.jboss.as.remoting\"/>\r\n        <extension module=\"org.jboss.as.security\"/>\r\n        <extension module=\"org.jboss.as.transactions\"/>\r\n        <extension module=\"org.keycloak.keycloak-server-subsystem\"/>\r\n        <extension module=\"org.wildfly.extension.bean-validation\"/>\r\n        <extension module=\"org.wildfly.extension.core-management\"/>\r\n        <extension module=\"org.wildfly.extension.elytron\"/>\r\n        <extension module=\"org.wildfly.extension.io\"/>\r\n        <extension module=\"org.wildfly.extension.microprofile.config-smallrye\"/>\r\n        <extension module=\"org.wildfly.extension.microprofile.health-smallrye\"/>\r\n        <extension module=\"org.wildfly.extension.microprofile.metrics-smallrye\"/>\r\n        <extension module=\"org.wildfly.extension.request-controller\"/>\r\n        <extension module=\"org.wildfly.extension.security.manager\"/>\r\n        <extension module=\"org.wildfly.extension.undertow\"/>\r\n    </extensions>\r\n    <management>\r\n        <security-realms>\r\n            <security-realm name=\"ManagementRealm\">\r\n                <authentication>\r\n                    <local default-user=\"$local\" skip-group-loading=\"true\"/>\r\n                    <properties path=\"mgmt-users.properties\" relative-to=\"jboss.server.config.dir\"/>\r\n                </authentication>\r\n                <authorization map-groups-to-roles=\"false\">\r\n                    <properties path=\"mgmt-groups.properties\" relative-to=\"jboss.server.config.dir\"/>\r\n                </authorization>\r\n            </security-realm>\r\n            <security-realm name=\"ApplicationRealm\">\r\n                <server-identities>\r\n                    <ssl>\r\n                        <keystore path=\"application.keystore\" relative-to=\"jboss.server.config.dir\" keystore-password=\"password\" alias=\"server\" key-password=\"password\" generate-self-signed-certificate-host=\"localhost\"/>\r\n                    </ssl>\r\n                </server-identities>\r\n                <authentication>\r\n                    <local default-user=\"$local\" allowed-users=\"*\" skip-group-loading=\"true\"/>\r\n                    <properties path=\"application-users.properties\" relative-to=\"jboss.server.config.dir\"/>\r\n                </authentication>\r\n                <authorization>\r\n                    <properties path=\"application-roles.properties\" relative-to=\"jboss.server.config.dir\"/>\r\n                </authorization>\r\n            </security-realm>\r\n        </security-realms>\r\n        <audit-log>\r\n            <formatters>\r\n                <json-formatter name=\"json-formatter\"/>\r\n            </formatters>\r\n            <handlers>\r\n                <file-handler name=\"file\" formatter=\"json-formatter\" path=\"audit-log.log\" relative-to=\"jboss.server.data.dir\"/>\r\n            </handlers>\r\n            <logger log-boot=\"true\" log-read-only=\"false\" enabled=\"false\">\r\n                <handlers>\r\n                    <handler name=\"file\"/>\r\n                </handlers>\r\n                          </logger>\r\n        </audit-log>\r\n        <management-interfaces>\r\n            <http-interface security-realm=\"ManagementRealm\">\r\n                <http-upgrade enabled=\"true\"/>\r\n                <socket-binding http=\"management-http\"/>\r\n            </http-interface>\r\n        </management-interfaces>\r\n        <access-control provider=\"simple\">\r\n            <role-mapping>\r\n                <role name=\"SuperUser\">\r\n                    <include>\r\n                        <user name=\"$local\"/>\r\n                    </include>\r\n                </role>\r\n            </role-mapping>\r\n        </access-control>\r\n    </management>\r\n    <profile>\r\n        <subsystem xmlns=\"urn:jboss:domain:logging:6.0\">\r\n            <console-handler name=\"CONSOLE\">\r\n                <level name=\"INFO\"/>\r\n                <formatter>\r\n                    <named-formatter name=\"COLOR-PATTERN\"/>\r\n                </formatter>\r\n            </console-handler>\r\n            <periodic-rotating-file-handler name=\"FILE\" autoflush=\"true\">\r\n                <formatter>\r\n                    <named-formatter name=\"PATTERN\"/>\r\n                </formatter>\r\n                <file relative-to=\"jboss.server.log.dir\" path=\"server.log\"/>\r\n                <suffix value=\".yyyy-MM-dd\"/>\r\n                <append value=\"true\"/>\r\n            </periodic-rotating-file-handler>\r\n            <logger category=\"com.arjuna\">\r\n                <level name=\"WARN\"/>\r\n            </logger>\r\n            <logger category=\"io.jaegertracing.Configuration\">\r\n                <level name=\"WARN\"/>\r\n            </logger>\r\n            <logger category=\"org.jboss.as.config\">\r\n                <level name=\"DEBUG\"/>\r\n            </logger>\r\n            <logger category=\"sun.rmi\">\r\n                <level name=\"WARN\"/>\r\n            </logger>\r\n            <root-logger>\r\n                <level name=\"INFO\"/>\r\n                <handlers>\r\n                    <handler name=\"CONSOLE\"/>\r\n                    <handler name=\"FILE\"/>\r\n                </handlers>\r\n            </root-logger>\r\n            <formatter name=\"PATTERN\">\r\n                <pattern-formatter pattern=\"%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n\"/>\r\n            </formatter>\r\n            <formatter name=\"COLOR-PATTERN\">\r\n                <pattern-formatter pattern=\"%K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n\"/>\r\n            </formatter>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:bean-validation:1.0\"/>\r\n        <subsystem xmlns=\"urn:jboss:domain:core-management:1.0\"/>\r\n        <subsystem xmlns=\"urn:jboss:domain:datasources:5.0\">\r\n            <datasources>\r\n                <datasource jndi-name=\"java:jboss/datasources/ExampleDS\" pool-name=\"ExampleDS\" enabled=\"true\" use-java-context=\"true\" statistics-enabled=\"${wildfly.datasources.statistics-enabled:${wi\r\nldfly.statistics-enabled:false}}\">\r\n                    <connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE</connection-url>\r\n                    <driver>h2</driver>\r\n     <security>\r\n                        <user-name>sa</user-name>\r\n                        <password>sa</password>\r\n                    </security>\r\n                </datasource>\r\n                <datasource jndi-name=\"java:jboss/datasources/KeycloakDS\" pool-name=\"KeycloakDS\" enabled=\"true\" use-java-context=\"true\" statistics-enabled=\"${wildfly.datasources.statistics-enabled:${\r\nwildfly.statistics-enabled:false}}\">\r\n                    <connection-url>jdbc:h2:${jboss.server.data.dir}/keycloak;AUTO_SERVER=TRUE</connection-url>\r\n                    <driver>h2</driver>\r\n                    <security>\r\n                        <user-name>sa</user-name>\r\n                        <password>sa</password>\r\n                    </security>\r\n                </datasource>\r\n                <drivers>\r\n                    <driver name=\"h2\" module=\"com.h2database.h2\">\r\n                        <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>\r\n                    </driver>\r\n                </drivers>\r\n            </datasources>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:deployment-scanner:2.0\">\r\n            <deployment-scanner path=\"deployments\" relative-to=\"jboss.server.base.dir\" scan-interval=\"5000\" runtime-failure-causes-rollback=\"${jboss.deployment.scanner.rollback.on.failure:false}\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:ee:4.0\">\r\n            <spec-descriptor-property-replacement>false</spec-descriptor-property-replacement>\r\n            <concurrent>\r\n                <context-services>\r\n                    <context-service name=\"default\" jndi-name=\"java:jboss/ee/concurrency/context/default\" use-transaction-setup-provider=\"true\"/>\r\n                </context-services>\r\n                <managed-thread-factories>\r\n                    <managed-thread-factory name=\"default\" jndi-name=\"java:jboss/ee/concurrency/factory/default\" context-service=\"default\"/>\r\n                </managed-thread-factories>\r\n                <managed-executor-services>\r\n                    <managed-executor-service name=\"default\" jndi-name=\"java:jboss/ee/concurrency/executor/default\" context-service=\"default\" hung-task-threshold=\"60000\" keepalive-time=\"5000\"/>\r\n                </managed-executor-services>\r\n                <managed-scheduled-executor-services>\r\n                    <managed-scheduled-executor-service name=\"default\" jndi-name=\"java:jboss/ee/concurrency/scheduler/default\" context-service=\"default\" hung-task-threshold=\"60000\" keepalive-time=\"3000\"/>\r\n                </managed-scheduled-executor-services>\r\n            </concurrent>\r\n            <default-bindings context-service=\"java:jboss/ee/concurrency/context/default\" datasource=\"java:jboss/datasources/ExampleDS\" managed-executor-service=\"java:jboss/ee/concurrency/executor/default\" managed-scheduled-executor-service=\"java:jboss/ee/concurrency/scheduler/default\" managed-thread-factory=\"java:jboss/ee/concurrency/factory/default\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:ejb3:5.0\">\r\n            <session-bean>\r\n                <stateless>\r\n                    <bean-instance-pool-ref pool-name=\"slsb-strict-max-pool\"/>\r\n                </stateless>\r\n                <stateful default-access-timeout=\"5000\" cache-ref=\"simple\" passivation-disabled-cache-ref=\"simple\"/>\r\n                <singleton default-access-timeout=\"5000\"/>\r\n            </session-bean>\r\n            <pools>\r\n                <bean-instance-pools>\r\n                    <strict-max-pool name=\"mdb-strict-max-pool\" derive-size=\"from-cpu-count\" instance-acquisition-timeout=\"5\" instance-acquisition-timeout-unit=\"MINUTES\"/>\r\n                    <strict-max-pool name=\"slsb-strict-max-pool\" derive-size=\"from-worker-pools\" instance-acquisition-timeout=\"5\" instance-acquisition-timeout-unit=\"MINUTES\"/>\r\n                </bean-instance-pools>\r\n            </pools>\r\n            <caches>\r\n                <cache name=\"simple\"/>\r\n                <cache name=\"distributable\" passivation-store-ref=\"infinispan\" aliases=\"passivating clustered\"/>\r\n            </caches>\r\n            <passivation-stores>\r\n                <passivation-store name=\"infinispan\" cache-container=\"ejb\" max-size=\"10000\"/>\r\n            </passivation-stores>\r\n            <async thread-pool-name=\"default\"/>\r\n            <timer-service thread-pool-name=\"default\" default-data-store=\"default-file-store\">\r\n                <data-stores>\r\n                  <file-data-store name=\"default-file-store\" path=\"timer-service-data\" relative-to=\"jboss.server.data.dir\"/>\r\n                </data-stores>\r\n           </timer-service>\r\n            <remote connector-ref=\"http-remoting-connector\" thread-pool-name=\"default\">\r\n                <channel-creation-options>\r\n                    <option name=\"READ_TIMEOUT\" value=\"${prop.remoting-connector.read.timeout:20}\" type=\"xnio\"/>\r\n                    <option name=\"MAX_OUTBOUND_MESSAGES\" value=\"1234\" type=\"remoting\"/>\r\n                </channel-creation-options>\r\n            </remote>\r\n            <thread-pools>\r\n                <thread-pool name=\"default\">\r\n                    <max-threads count=\"10\"/>\r\n                    <keepalive-time time=\"100\" unit=\"milliseconds\"/>\r\n                </thread-pool>\r\n            </thread-pools>\r\n            <default-security-domain value=\"other\"/>\r\n            <default-missing-method-permissions-deny-access value=\"true\"/>\r\n            <statistics enabled=\"${wildfly.ejb3.statistics-enabled:${wildfly.statistics-enabled:false}}\"/>\r\n            <log-system-exceptions value=\"true\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:io:3.0\">\r\n            <worker name=\"default\"/>\r\n            <buffer-pool name=\"default\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:infinispan:8.0\">\r\n            <cache-container name=\"keycloak\">\r\n                <local-cache name=\"realms\">\r\n                    <object-memory size=\"10000\"/>\r\n                </local-cache>\r\n                <local-cache name=\"users\">\r\n                    <object-memory size=\"10000\"/>\r\n                </local-cache>\r\n                <local-cache name=\"sessions\"/>\r\n                <local-cache name=\"authenticationSessions\"/>\r\n                <local-cache name=\"offlineSessions\"/>\r\n                <local-cache name=\"clientSessions\"/>\r\n                <local-cache name=\"offlineClientSessions\"/>\r\n                <local-cache name=\"loginFailures\"/>\r\n                <local-cache name=\"work\"/>\r\n                <local-cache name=\"authorization\">\r\n                    <object-memory size=\"10000\"/>\r\n                </local-cache>\r\n                <local-cache name=\"keys\">\r\n                    <object-memory size=\"1000\"/>\r\n                    <expiration max-idle=\"3600000\"/>\r\n                </local-cache>\r\n                <local-cache name=\"actionTokens\">\r\n                    <object-memory size=\"-1\"/>\r\n                    <expiration max-idle=\"-1\" interval=\"300000\"/>\r\n                </local-cache>\r\n            </cache-container>\r\n            <cache-container name=\"server\" default-cache=\"default\" module=\"org.wildfly.clustering.server\">\r\n                <local-cache name=\"default\">\r\n                    <transaction mode=\"BATCH\"/>\r\n                </local-cache>\r\n            </cache-container>\r\n            <cache-container name=\"web\" default-cache=\"passivation\" module=\"org.wildfly.clustering.web.infinispan\">\r\n                <local-cache name=\"passivation\">\r\n                    <locking isolation=\"REPEATABLE_READ\"/>\r\n                    <transaction mode=\"BATCH\"/>\r\n                    <file-store passivation=\"true\" purge=\"false\"/>\r\n                </local-cache>\r\n            </cache-container>\r\n            <cache-container name=\"ejb\" aliases=\"sfsb\" default-cache=\"passivation\" module=\"org.wildfly.clustering.ejb.infinispan\">\r\n                <local-cache name=\"passivation\">\r\n                    <locking isolation=\"REPEATABLE_READ\"/>\r\n                    <transaction mode=\"BATCH\"/>\r\n                    <file-store passivation=\"true\" purge=\"false\"/>\r\n                </local-cache>\r\n            </cache-container>\r\n            <cache-container name=\"hibernate\" module=\"org.infinispan.hibernate-cache\">\r\n                <local-cache name=\"entity\">\r\n                    <object-memory size=\"10000\"/>\r\n                    <expiration max-idle=\"100000\"/>\r\n                </local-cache>\r\n                <local-cache name=\"local-query\">\r\n                    <object-memory size=\"10000\"/>\r\n                    <expiration max-idle=\"100000\"/>\r\n                </local-cache>\r\n                <local-cache name=\"timestamps\"/>\r\n            </cache-container>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:jaxrs:1.0\"/>\r\n        <subsystem xmlns=\"urn:jboss:domain:jca:5.0\">\r\n            <archive-validation enabled=\"true\" fail-on-error=\"true\" fail-on-warn=\"false\"/>\r\n            <bean-validation enabled=\"true\"/>\r\n            <default-workmanager>\r\n                <short-running-threads>\r\n                    <core-threads count=\"50\"/>\r\n                    <queue-length count=\"50\"/>\r\n                    <max-threads count=\"50\"/>\r\n                    <keepalive-time time=\"10\" unit=\"seconds\"/>\r\n                </short-running-threads>\r\n                <long-running-threads>\r\n                    <core-threads count=\"50\"/>\r\n                    <queue-length count=\"50\"/>\r\n                    <max-threads count=\"50\"/>\r\n                    <keepalive-time time=\"10\" unit=\"seconds\"/>\r\n                </long-running-threads>\r\n            </default-workmanager>\r\n            <cached-connection-manager/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:jmx:1.3\">\r\n            <expose-resolved-model/>\r\n            <expose-expression-model/>\r\n            <remoting-connector/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:jpa:1.1\">\r\n            <jpa default-datasource=\"\" default-extended-persistence-inheritance=\"DEEP\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:mail:3.0\">\r\n            <mail-session name=\"default\" jndi-name=\"java:jboss/mail/Default\">\r\n                <smtp-server outbound-socket-binding-ref=\"mail-smtp\"/>\r\n            </mail-session>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:naming:2.0\">\r\n            <remote-naming/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:remoting:4.0\">\r\n            <http-connector name=\"http-remoting-connector\" connector-ref=\"default\" security-realm=\"ApplicationRealm\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:request-controller:1.0\"/>\r\n        <subsystem xmlns=\"urn:jboss:domain:security-manager:1.0\">\r\n            <deployment-permissions>\r\n                <maximum-set>\r\n                    <permission class=\"java.security.AllPermission\"/>\r\n                </maximum-set>\r\n            </deployment-permissions>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:wildfly:elytron:6.0\" final-providers=\"combined-providers\" disallowed-providers=\"OracleUcrypto\">\r\n            <providers>\r\n                <aggregate-providers name=\"combined-providers\">\r\n                    <providers name=\"elytron\"/>\r\n                    <providers name=\"openssl\"/>\r\n                </aggregate-providers>\r\n                <provider-loader name=\"elytron\" module=\"org.wildfly.security.elytron\"/>\r\n                <provider-loader name=\"openssl\" module=\"org.wildfly.openssl\"/>\r\n            </providers>\r\n            <audit-logging>\r\n                <file-audit-log name=\"local-audit\" path=\"audit.log\" relative-to=\"jboss.server.log.dir\" format=\"JSON\"/>\r\n            </audit-logging>\r\n            <security-domains>\r\n                <security-domain name=\"ApplicationDomain\" default-realm=\"ApplicationRealm\" permission-mapper=\"default-permission-mapper\">\r\n                    <realm name=\"ApplicationRealm\" role-decoder=\"groups-to-roles\"/>\r\n                    <realm name=\"local\"/>\r\n                </security-domain>\r\n                <security-domain name=\"ManagementDomain\" default-realm=\"ManagementRealm\" permission-mapper=\"default-permission-mapper\">\r\n                    <realm name=\"ManagementRealm\" role-decoder=\"groups-to-roles\"/>\r\n                    <realm name=\"local\" role-mapper=\"super-user-mapper\"/>\r\n                </security-domain>\r\n            </security-domains>\r\n            <security-realms>\r\n                <identity-realm name=\"local\" identity=\"$local\"/>\r\n                <properties-realm name=\"ApplicationRealm\">\r\n                    <users-properties path=\"application-users.properties\" relative-to=\"jboss.server.config.dir\" digest-realm-name=\"ApplicationRealm\"/>\r\n                    <groups-properties path=\"application-roles.properties\" relative-to=\"jboss.server.config.dir\"/>\r\n                </properties-realm>\r\n                <properties-realm name=\"ManagementRealm\">\r\n                    <users-properties path=\"mgmt-users.properties\" relative-to=\"jboss.server.config.dir\" digest-realm-name=\"ManagementRealm\"/>\r\n                    <groups-properties path=\"mgmt-groups.properties\" relative-to=\"jboss.server.config.dir\"/>\r\n                </properties-realm>\r\n            </security-realms>\r\n            <mappers>\r\n                <simple-permission-mapper name=\"default-permission-mapper\" mapping-mode=\"first\">\r\n                    <permission-mapping>\r\n                        <principal name=\"anonymous\"/>\r\n                        <permission-set name=\"default-permissions\"/>\r\n                    </permission-mapping>\r\n                    <permission-mapping match-all=\"true\">\r\n                        <permission-set name=\"login-permission\"/>\r\n                        <permission-set name=\"default-permissions\"/>\r\n                    </permission-mapping>\r\n                </simple-permission-mapper>\r\n                <constant-realm-mapper name=\"local\" realm-name=\"local\"/>\r\n                <simple-role-decoder name=\"groups-to-roles\" attribute=\"groups\"/>\r\n                <constant-role-mapper name=\"super-user-mapper\">\r\n                    <role name=\"SuperUser\"/>\r\n                </constant-role-mapper>\r\n            </mappers>\r\n            <permission-sets>\r\n                <permission-set name=\"login-permission\">\r\n                    <permission class-name=\"org.wildfly.security.auth.permission.LoginPermission\"/>\r\n                </permission-set>\r\n                <permission-set name=\"default-permissions\">\r\n                    <permission class-name=\"org.wildfly.extension.batch.jberet.deployment.BatchPermission\" module=\"org.wildfly.extension.batch.jberet\" target-name=\"*\"/>\r\n                    <permission class-name=\"org.wildfly.transaction.client.RemoteTransactionPermission\" module=\"org.wildfly.transaction.client\"/>\r\n                    <permission class-name=\"org.jboss.ejb.client.RemoteEJBPermission\" module=\"org.jboss.ejb-client\"/>\r\n                </permission-set>\r\n            </permission-sets>\r\n            <http>\r\n                <http-authentication-factory name=\"management-http-authentication\" security-domain=\"ManagementDomain\" http-server-mechanism-factory=\"global\">\r\n                    <mechanism-configuration>\r\n                        <mechanism mechanism-name=\"DIGEST\">\r\n                            <mechanism-realm realm-name=\"ManagementRealm\"/>\r\n                        </mechanism>\r\n                    </mechanism-configuration>\r\n                </http-authentication-factory>\r\n                <provider-http-server-mechanism-factory name=\"global\"/>\r\n            </http>\r\n            <sasl>\r\n                <sasl-authentication-factory name=\"application-sasl-authentication\" sasl-server-factory=\"configured\" security-domain=\"ApplicationDomain\">\r\n                    <mechanism-configuration>\r\n                        <mechanism mechanism-name=\"JBOSS-LOCAL-USER\" realm-mapper=\"local\"/>\r\n                        <mechanism mechanism-name=\"DIGEST-MD5\">\r\n                            <mechanism-realm realm-name=\"ApplicationRealm\"/>\r\n                        </mechanism>\r\n                    </mechanism-configuration>\r\n                </sasl-authentication-factory>\r\n                <sasl-authentication-factory name=\"management-sasl-authentication\" sasl-server-factory=\"configured\" security-domain=\"ManagementDomain\">\r\n                    <mechanism-configuration>\r\n                        <mechanism mechanism-name=\"JBOSS-LOCAL-USER\" realm-mapper=\"local\"/>\r\n                        <mechanism mechanism-name=\"DIGEST-MD5\">\r\n                            <mechanism-realm realm-name=\"ManagementRealm\"/>\r\n                        </mechanism>\r\n                    </mechanism-configuration>\r\n                </sasl-authentication-factory>\r\n                <configurable-sasl-server-factory name=\"configured\" sasl-server-factory=\"elytron\">\r\n                    <properties>\r\n                        <property name=\"wildfly.sasl.local-user.default-user\" value=\"$local\"/>\r\n                    </properties>\r\n                </configurable-sasl-server-factory>\r\n                <mechanism-provider-filtering-sasl-server-factory name=\"elytron\" sasl-server-factory=\"global\">\r\n                    <filters>\r\n                        <filter provider-name=\"WildFlyElytron\"/>\r\n                    </filters>\r\n                </mechanism-provider-filtering-sasl-server-factory>\r\n                <provider-sasl-server-factory name=\"global\"/>\r\n            </sasl>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:security:2.0\">\r\n            <security-domains>\r\n                <security-domain name=\"other\" cache-type=\"default\">\r\n                    <authentication>\r\n                        <login-module code=\"Remoting\" flag=\"optional\">\r\n                            <module-option name=\"password-stacking\" value=\"useFirstPass\"/>\r\n                        </login-module>\r\n                        <login-module code=\"RealmDirect\" flag=\"required\">\r\n                            <module-option name=\"password-stacking\" value=\"useFirstPass\"/>\r\n                        </login-module>\r\n                    </authentication>\r\n                </security-domain>\r\n                <security-domain name=\"jboss-web-policy\" cache-type=\"default\">\r\n                    <authorization>\r\n                        <policy-module code=\"Delegating\" flag=\"required\"/>\r\n                    </authorization>\r\n                </security-domain>\r\n                <security-domain name=\"jaspitest\" cache-type=\"default\">\r\n                    <authentication-jaspi>\r\n                        <login-module-stack name=\"dummy\">\r\n                            <login-module code=\"Dummy\" flag=\"optional\"/>\r\n                        </login-module-stack>\r\n                        <auth-module code=\"Dummy\"/>\r\n                    </authentication-jaspi>\r\n                </security-domain>\r\n                <security-domain name=\"jboss-ejb-policy\" cache-type=\"default\">\r\n                    <authorization>\r\n                        <policy-module code=\"Delegating\" flag=\"required\"/>\r\n                    </authorization>\r\n                </security-domain>\r\n            </security-domains>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:transactions:5.0\">\r\n            <core-environment node-identifier=\"${jboss.tx.node.id:1}\">\r\n                <process-id>\r\n                    <uuid/>\r\n                </process-id>\r\n            </core-environment>\r\n            <recovery-environment socket-binding=\"txn-recovery-environment\" status-socket-binding=\"txn-status-manager\"/>\r\n            <coordinator-environment statistics-enabled=\"${wildfly.transactions.statistics-enabled:${wildfly.statistics-enabled:false}}\"/>\r\n            <object-store path=\"tx-object-store\" relative-to=\"jboss.server.data.dir\"/>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:wildfly:microprofile-config-smallrye:1.0\"/>\r\n     <subsystem xmlns=\"urn:wildfly:microprofile-health-smallrye:1.0\" security-enabled=\"false\"/>\r\n        <subsystem xmlns=\"urn:wildfly:microprofile-metrics-smallrye:2.0\" security-enabled=\"false\" exposed-subsystems=\"*\" prefix=\"${wildfly.metrics.prefix:wildfly}\"/>\r\n        <subsystem xmlns=\"urn:jboss:domain:undertow:8.0\" default-server=\"default-server\" default-virtual-host=\"default-host\" default-servlet-container=\"default\" default-security-domain=\"other\" statistics-enabled=\"${wildfly.undertow.statistics-enabled:${wildfly.statistics-enabled:false}}\">\r\n            <buffer-cache name=\"default\"/>\r\n            <server name=\"default-server\">\r\n                <http-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\" enable-http2=\"true\"  proxy-address-forwarding=\"true\"/>\r\n                <https-listener name=\"https\" socket-binding=\"https\" security-realm=\"ApplicationRealm\" enable-http2=\"true\"/>\r\n                <host name=\"default-host\" alias=\"localhost\">\r\n                    <location name=\"/\" handler=\"welcome-content\"/>\r\n                    <http-invoker security-realm=\"ApplicationRealm\"/>\r\n                </host>\r\n            </server>\r\n            <servlet-container name=\"default\">\r\n                <jsp-config/>\r\n                <websockets/>\r\n            </servlet-container>\r\n            <handlers>\r\n                <file name=\"welcome-content\" path=\"${jboss.home.dir}/welcome-content\"/>\r\n            </handlers>\r\n        </subsystem>\r\n        <subsystem xmlns=\"urn:jboss:domain:keycloak-server:1.1\">\r\n            <web-context>auth</web-context>\r\n            <providers>\r\n                <provider>classpath:${jboss.home.dir}/providers/*</provider>\r\n            </providers>\r\n            <master-realm-name>master</master-realm-name>\r\n            <scheduled-task-interval>900</scheduled-task-interval>\r\n            <theme>\r\n                <staticMaxAge>2592000</staticMaxAge>\r\n                <cacheThemes>true</cacheThemes>\r\n                <cacheTemplates>true</cacheTemplates>\r\n                <dir>${jboss.home.dir}/themes</dir>\r\n            </theme>\r\n            <spi name=\"eventsStore\">\r\n                <provider name=\"jpa\" enabled=\"true\">\r\n                    <properties>\r\n                        <property name=\"exclude-events\" value=\"[&quot;REFRESH_TOKEN&quot;]\"/>\r\n                    </properties>\r\n                </provider>\r\n            </spi>\r\n            <spi name=\"userCache\">\r\n                <provider name=\"default\" enabled=\"true\"/>\r\n            </spi>\r\n            <spi name=\"userSessionPersister\">\r\n                <default-provider>jpa</default-provider>\r\n            </spi>\r\n            <spi name=\"timer\">\r\n                <default-provider>basic</default-provider>\r\n            </spi>\r\n            <spi name=\"connectionsHttpClient\">\r\n                <provider name=\"default\" enabled=\"true\"/>\r\n            </spi>\r\n            <spi name=\"connectionsJpa\">\r\n                <provider name=\"default\" enabled=\"true\">\r\n                    <properties>\r\n                        <property name=\"dataSource\" value=\"java:jboss/datasources/KeycloakDS\"/>\r\n                        <property name=\"initializeEmpty\" value=\"true\"/>\r\n                        <property name=\"migrationStrategy\" value=\"update\"/>\r\n                        <property name=\"migrationExport\" value=\"${jboss.home.dir}/keycloak-database-update.sql\"/>\r\n                    </properties>\r\n                </provider>\r\n            </spi>\r\n            <spi name=\"realmCache\">\r\n                <provider name=\"default\" enabled=\"true\"/>\r\n            </spi>\r\n            <spi name=\"connectionsInfinispan\">\r\n                <default-provider>default</default-provider>\r\n                <provider name=\"default\" enabled=\"true\">\r\n                    <properties>\r\n                        <property name=\"cacheContainer\" value=\"java:jboss/infinispan/container/keycloak\"/>\r\n                    </properties>\r\n                </provider>\r\n            </spi>\r\n            <spi name=\"jta-lookup\">\r\n                <default-provider>${keycloak.jta.lookup.provider:jboss}</default-provider>\r\n                <provider name=\"jboss\" enabled=\"true\"/>\r\n            </spi>\r\n            <spi name=\"publicKeyStorage\">\r\n                <provider name=\"infinispan\" enabled=\"true\">\r\n                    <properties>\r\n                        <property name=\"minTimeBetweenRequests\" value=\"10\"/>\r\n                    </properties>\r\n                </provider>\r\n            </spi>\r\n            <spi name=\"x509cert-lookup\">\r\n                <default-provider>${keycloak.x509cert.lookup.provider:default}</default-provider>\r\n                <provider name=\"default\" enabled=\"true\"/>\r\n            </spi>\r\n            <spi name=\"hostname\">\r\n                <default-provider>request</default-provider>\r\n                <provider name=\"fixed\" enabled=\"true\">\r\n                    <properties>\r\n                        <property name=\"hostname\" value=\"localhost\"/>\r\n                        <property name=\"httpPort\" value=\"-1\"/>\r\n                        <property name=\"httpsPort\" value=\"-1\"/>\r\n                    </properties>\r\n                </provider>\r\n            </spi>\r\n        </subsystem>\r\n    </profile>\r\n    <interfaces>\r\n        <interface name=\"management\">\r\n            <inet-address value=\"${jboss.bind.address.management:0.0.0.0}\"/>\r\n        </interface>\r\n        <interface name=\"public\">\r\n            <inet-address value=\"${jboss.bind.address:0.0.0.0}\"/>\r\n        </interface>\r\n    </interfaces>\r\n    <socket-binding-group name=\"standard-sockets\" default-interface=\"public\" port-offset=\"${jboss.socket.binding.port-offset:0}\">\r\n        <socket-binding name=\"management-http\" interface=\"management\" port=\"${jboss.management.http.port:9990}\"/>\r\n        <socket-binding name=\"management-https\" interface=\"management\" port=\"${jboss.management.https.port:9993}\"/>\r\n        <socket-binding name=\"ajp\" port=\"${jboss.ajp.port:8009}\"/>\r\n        <socket-binding name=\"http\" port=\"${jboss.http.port:8080}\"/> \r\n<socket-binding name=\"proxy-https\" port=\"443\"/>\r\n        <socket-binding name=\"https\" port=\"${jboss.https.port:8443}\"/>\r\n        <socket-binding name=\"txn-recovery-environment\" port=\"4712\"/>\r\n        <socket-binding name=\"txn-status-manager\" port=\"4713\"/>\r\n        <outbound-socket-binding name=\"mail-smtp\">\r\n            <remote-destination host=\"smtp\" port=\"25\"/>\r\n        </outbound-socket-binding>\r\n    </socket-binding-group>\r\n</server>"
      }
    ],
    "persistent_directories": [
      {
        "path": "/home/app/keycloak/standalone/log",
        "volume_name": "log"
      }
    ]
  }
}
